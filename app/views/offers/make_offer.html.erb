<script src="/javascripts/jquery/jquery.ui.widget.js"></script>
<script src="/javascripts/jquery/jquery.ui.draggable.js"></script>
<script src="/javascripts/jquery/jquery.ui.droppable.js"></script>

<h2>Build your offer</h2>

<% form_for :offer, :url => send_counter_offer_path(@offer) do |f| %>

<div id="offer-wrapper">
	<div id="offer-details">
		
			<div id="available-items">
				
				<div id="offering-items-available">
					<%= render "offering_items_available", :offer => @offer, :user => @user %>
				</div>
				<div id="dropbox">
					DROP STUFF HERE TO START TRADING
					<img src="http://icons.iconarchive.com/icons/raindropmemory/in-spirited-we-love/256/Dropbox-icon.png" />
				</div>
				<div id="wanted-items-available">
					<%= render "wanted_items_available", :sender => @sender, :offer => @offer %>
				</div>
			</div>

			<div id="offering-items">
				<div class="page-break" style="top: 20px"></div>
				
				<div id="offering-items-offered">
					<%= render "offering_items_offered", :offer => @offer %>
				</div>
				
				<div id="suggested-value-wrapper">
					<div id="value-calc">
						<div id="their-value"><div class="side-note-tag">Their items' value</div><div class="cash-value"></div></div>
						<div id="my-value"><div class="side-note-tag">My items' value</div><div class="cash-value"></div></div>
						<div id="diff"><div class="side-note-tag diff">Diff</div><div class="cash-value"></div></div>
						<div class="cash-compensate">
							<label>They pay</label>
							<%= text_field(:offer, :cash_value, :value => 0, :size => 10) %>
							<%= hidden_field_tag 'offer_cash_value_hidden', 0 %>
						</div>
						<div id="send-button">
							<%= submit_tag "Send offer", :name => "send_offer" %>
						</div>
						<div id="suggested-value-outer">
					<!--		<div id="suggested-text"></div> 
							<div id="suggested-value"></div> -->
						</div>
					</div>
				</div>
				
				<div id="wanted-items-offered">
					<%= render "wanted_items_offered", :offer => @offer %>
				</div>
				
				<div class="page-break" style="top: 50px;"></div>
			</div>
			
	</div> <!-- end of offer-details -->

</div>
<% end #end form%>

<script type="text/javascript">
	makeDraggable("their-available-item-list");
	makeDraggable("my-available-item-list");
	makeDraggable("their-available-service-list");
	
	// initial update
	updateSuggestedValue();
	/*
	// initialize values
	var cashExtra = parseFloat($("#offer_cash_value_hidden").val());
	if (cashExtra == 0) {
		$("#cash-extra").css("display", "none");
	} else {
		$("#my-value").css("border-bottom", "none");
		if (cashExtra < 0) { // they asked me to pay extra cash
			$("#cash-extra").removeClass("cash-request").addClass("cash-offer");
		}
	}
	*/
	
</script>